# Database Maintenance

The database is core to the operation of orcidlink, so we like to keep it nice and tidy.
To achieve this the api provides management functionality which may be used manually or
through automation scripts.

## Deleting Expired Linking Sessions

When creating a link, a temporary linking session is created. A linking session has a
10-minute time limit If the linking session is run to completion, the linking session is
deleted when the link is created. However, if the linking session is abandoned, it will
remain in the database until deleted by some other process.

Linking sessions exist in three forms: initial, started (in progress), and completed.
Completed sessions are created after the user has authorized at ORCID, and contain the
access token and other information provided by ORCID. By indicating they want to
complete the link, the user will cause this "completed" linking session to be removed,
and the token information to be added to a new link record. By canceling the link, the
user will cause the completed linking session to be deleted, but no link will be
created.

When a linking session is older than 10 minutes, it cannot be used, and is considered to
be "expired". However, they exist in the database until deleted.

Lingering expired linking sessions do not cause signficant database performance or
integrity issues, at least at the volume we will have. However, they do complicate
management of the service, and "completed" sessions contain an active access key that
should be deactivated.

> Each access key generated by ORCID creates an authorization record in their system,
> which persists until either administratively removed, the token is revoked, or the
> user de-authorizes KBase as a trusted party.

The management interface provides two methods of removing such sessions. A manager may
directly remove any linking session, expired or not. A manager may also use the "Delete
Expired Sessions" button to remove all expired sessions in one go.

The latter function is provided by a single management API call. This call may also be
invoked by an automation script.

### 
